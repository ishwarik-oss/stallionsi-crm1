<!DOCTYPE html>
<html>
  
<head>
  <meta name="google-site-verification" content="S4SlXH08t-pNRDAP7D4bESdT0tg2DA5G5sUrCvG45hs" />
  <title>New Opportunity Form</title>
  <style>
    body { font-family: Arial; margin: 40px; }
    input, select { margin: 10px 0; width: 300px; padding: 8px; }
    button { padding: 10px 20px; }
  </style>
</head>
<body>
  <h2>New Opportunity</h2>
  <form id="opportunityForm">
    <input type="text" name="partnerName" placeholder="Partner Name" required><br>
    <input type="text" name="subPartnerName" placeholder="Sub Partner Name"><br>
    <input type="text" name="customerName" placeholder="Customer Name" required><br>
    <input type="text" name="contactPerson" placeholder="Contact Person" required><br>
    <input type="text" name="technology" placeholder="Technology / Platform"><br>
    <input type="text" name="engineer" placeholder="Engineer (Primary)" required><br>
    <input type="text" name="engineerID" placeholder="Engineer Alias / ID"><br>
    <input type="number" name="hoursAssigned" placeholder="Estimated Hours"><br>
    <select name="projectType" required>
      <option value="">Select Project Type</option>
      <option value="T&M">T&M</option>
      <option value="Fixed-Bid">Fixed-Bid</option>
      <option value="Staffing">Staffing</option>
    </select><br>
    <input type="date" name="startDate" required><br>
    <button type="submit">Submit</button>
  </form>

  <script>
    document.getElementById('opportunityForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const form = e.target;
      const data = {
        partnerName: form.partnerName.value,
        subPartnerName: form.subPartnerName.value,
        customerName: form.customerName.value,
        contactPerson: form.contactPerson.value,
        technology: form.technology.value,
        engineer: form.engineer.value,
        engineerID: form.engineerID.value,
        hoursAssigned: form.hoursAssigned.value,
        projectType: form.projectType.value,
        startDate: form.startDate.value
      };

      fetch("https://script.google.com/macros/s/AKfycbzBVqO3rFdsJIWHX44QMh9R9N8hY1wfhVWiRfiBRk437OoENL3cNGcjyZkfhJeOhXkbdg/exec", {
        method: "POST",
        body: JSON.stringify(data)
      })
      .then(res => res.text())
      .then(response => alert("Submitted Successfully!"))
      .catch(err => alert("Error: " + err));
    });
  </script>
</body>
</html>
